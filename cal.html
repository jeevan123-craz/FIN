<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üíº JEEVANKISHORE FINANCE CO</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f6f8;
      color: #333;
    }

    header {
      background: #1a1f36;
      color: #fff;
      padding: 25px 20px;
      text-align: center;
      position: relative;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    header h1 {
      margin: 0;
      font-size: 28px;
      letter-spacing: 1px;
    }

    .service-btn {
      position: absolute;
      top: 25px;
      right: 20px;
      padding: 10px 16px;
      background: #28a745;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }

    .service-btn:hover { background: #218838; }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 25px;
      padding: 30px 20px;
    }

    .card {
      background: #fff;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      transition: 0.3s;
    }

    h2 {
      color: #1a1f36;
      margin-bottom: 20px;
      font-size: 22px;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
      color: #555;
    }

    input {
      padding: 10px 12px;
      width: 100%;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
      outline: none;
      transition: 0.3s;
    }

    input:focus {
      border-color: #007bff;
      box-shadow: 0 0 5px rgba(0,123,255,0.3);
    }

    button {
      margin-top: 12px;
      padding: 10px 18px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: 0.3s;
    }

    button:hover { background: #0056b3; }

    #result {
      margin-top: 15px;
      padding: 15px;
      border-radius: 10px;
      background: #f1f3f6;
      font-size: 15px;
      line-height: 1.5;
      color: #333;
    }

    .expense-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 15px;
      margin-top: 12px;
    }

    .expense-row input[type="number"] {
      flex: 0.5;
      font-weight: bold;
      font-size: 16px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      text-align: left;
    }

    .expense-row label {
      flex: 1;
      font-weight: 600;
      font-size: 16px;
      color: #555;
      text-align: left;
    }

    .expense-row button {
      flex: 0.2;
      background: #28a745;
      color: white;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    .expense-row button:hover { background: #218838; }
  </style>
</head>
<body>
  <header>
    <h1>üíº JEEVANKISHORE FINANCE CO</h1>
    <button class="service-btn" onclick="location.href='service.html'">üîó Services</button>
  </header>

  <div class="grid">
    <!-- Expense Tracker -->
    <div class="card">
      <h2>üí∞ Monthly Expense Tracker</h2>
      <label>Monthly Salary:</label>
      <input type="number" id="salary" placeholder="‚Çπ Enter your salary">
      <h3>Expenses</h3>
      <div id="expenseList"></div>
      <div class="expense-row">
        <input type="text" id="newCategory" placeholder="Add new category e.g., Fuel">
        <button onclick="addCategory()">‚ûï Add</button>
      </div>
      <button onclick="calculate()">Calculate Balance</button>
      <button onclick="exportExcel('expense')">üì§ Export</button>
      <input type="email" id="expenseEmail" placeholder="Recipient Email">
      <button onclick="sendExcel('expense')">üìß Send</button>
      <div id="result"></div>
    </div>

    <!-- EMI Calculator -->
    <div class="card">
      <h2>üè¶ EMI Calculator</h2>
      <label>Loan Amount:</label>
      <input type="number" id="loanAmount" placeholder="‚Çπ Loan amount">
      <label>Interest Rate (% per annum):</label>
      <input type="number" id="interestRate" placeholder="e.g., 8.5">
      <label>Tenure (in months):</label>
      <input type="number" id="tenure" placeholder="Months">
      <button onclick="calculateEMI()">Calculate EMI</button>
      <button onclick="exportExcel('emi')">üì§ Export</button>
      <input type="email" id="emiEmail" placeholder="Recipient Email">
      <button onclick="sendExcel('emi')">üìß Send</button>
      <div id="emiResult"></div>
    </div>

    <!-- Mileage Calculator -->
    <div class="card">
      <h2>‚õΩ Mileage Calculator</h2>
      <label>Distance Travelled (km):</label>
      <input type="number" id="distance" placeholder="km">
      <label>Fuel Consumed (litres):</label>
      <input type="number" id="fuel" placeholder="litres">
      <button onclick="calculateMileage()">Calculate Mileage</button>
      <button onclick="exportExcel('mileage')">üì§ Export</button>
      <input type="email" id="mileageEmail" placeholder="Recipient Email">
      <button onclick="sendExcel('mileage')">üìß Send</button>
      <div id="mileageResult"></div>
    </div>

    <!-- Income Tax Calculator -->
    <div class="card">
      <h2>üí∏ Income Tax Calculator</h2>
      <label>Annual Income:</label>
      <input type="number" id="income" placeholder="‚Çπ Annual income">
      <label>Deductions (‚Çπ):</label>
      <input type="number" id="deductions" placeholder="‚Çπ Deductions">
      <button onclick="calculateTax()">Calculate Tax</button>
      <button onclick="exportExcel('tax')">üì§ Export</button>
      <input type="email" id="taxEmail" placeholder="Recipient Email">
      <button onclick="sendExcel('tax')">üìß Send</button>
      <div id="taxResult"></div>
    </div>
  </div>

  <!-- Excel + EmailJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@2/dist/email.min.js"></script>
  <script>
    // Initialize EmailJS
    (function(){ emailjs.init("YOUR_USER_ID"); })();

    // Expense Tracker
    let categories = JSON.parse(localStorage.getItem("categories")) || [
      { name: "Groceries", value: 0 },
      { name: "Medical", value: 0 },
      { name: "Shopping", value: 0 }
    ];
    window.onload = () => { 
      document.getElementById("salary").value = localStorage.getItem("salary") || ""; 
      renderCategories(); 
    };
    function renderCategories() {
      const container = document.getElementById("expenseList");
      container.innerHTML = "";
      categories.forEach((cat, index) => {
        container.innerHTML += `
          <div class="expense-row">
            <input type="number" value="${cat.value}" onchange="updateCategory(${index}, this.value)">
            <label>${cat.name}</label>
            <button onclick="removeCategory(${index})">üóëÔ∏è</button>
          </div>`;
      });
    }
    function updateCategory(i,v){categories[i].value=parseFloat(v)||0;localStorage.setItem("categories",JSON.stringify(categories));}
    function addCategory(){const n=document.getElementById("newCategory").value.trim();if(!n)return;categories.push({name:n,value:0});localStorage.setItem("categories",JSON.stringify(categories));renderCategories();}

    function calculate() {
      const salary = parseFloat(document.getElementById("salary").value)||0;
      localStorage.setItem("salary",salary);
      let totalExpenses=categories.reduce((s,c)=>s+(c.value||0),0);
      const balance=salary-totalExpenses;
      document.getElementById("result").innerHTML=`<p><b>Total Expenses:</b> ‚Çπ${totalExpenses}</p><p><b>Remaining Balance:</b> ‚Çπ${balance}</p>`;
    }

    // EMI
    function calculateEMI(){
      const P=parseFloat(document.getElementById("loanAmount").value)||0;
      const R=(parseFloat(document.getElementById("interestRate").value)||0)/12/100;
      const N=parseFloat(document.getElementById("tenure").value)||0;
      if(P<=0||R<=0||N<=0){document.getElementById("emiResult").innerText="Enter valid values";return;}
      const emi=P*R*Math.pow(1+R,N)/(Math.pow(1+R,N)-1);
      document.getElementById("emiResult").innerHTML=`<p><b>Monthly EMI:</b> ‚Çπ${emi.toFixed(2)}</p>`;
    }

    // Mileage
    function calculateMileage(){
      const d=parseFloat(document.getElementById("distance").value)||0;
      const f=parseFloat(document.getElementById("fuel").value)||0;
      if(d<=0||f<=0){document.getElementById("mileageResult").innerText="Enter valid values";return;}
      const m=d/f;
      document.getElementById("mileageResult").innerHTML=`<p><b>Mileage:</b> ${m.toFixed(2)} km/l</p>`;
    }

    // Tax
    function calculateTax(){
      const income=parseFloat(document.getElementById("income").value)||0;
      const deductions=parseFloat(document.getElementById("deductions").value)||0;
      const taxable=income-deductions;
      let tax=0;
      if(taxable<=250000)tax=0;
      else if(taxable<=500000)tax=0.05*(taxable-250000);
      else if(taxable<=1000000)tax=12500+0.2*(taxable-500000);
      else tax=112500+0.3*(taxable-1000000);
      document.getElementById("taxResult").innerHTML=`<p><b>Taxable Income:</b> ‚Çπ${taxable}</p><p><b>Tax Payable:</b> ‚Çπ${tax.toFixed(2)}</p>`;
    }

    // Export & Send
    function exportExcel(type){
      let data=[["Field","Value"]];
      if(type==="expense"){
        const salary=parseFloat(document.getElementById("salary").value)||0;
        let total=categories.reduce((s,c)=>s+(c.value||0),0);
        let balance=salary-total;
        categories.forEach(c=>data.push([c.name,c.value]));
        data.push(["Total Expenses",total],["Salary",salary],["Remaining Balance",balance]);
      }
      if(type==="emi"){
        data.push(["Loan Amount",document.getElementById("loanAmount").value]);
        data.push(["Interest Rate",document.getElementById("interestRate").value]);
        data.push(["Tenure",document.getElementById("tenure").value]);
        data.push(["EMI",document.getElementById("emiResult").innerText]);
      }
      if(type==="mileage"){
        data.push(["Distance",document.getElementById("distance").value]);
        data.push(["Fuel",document.getElementById("fuel").value]);
        data.push(["Mileage",document.getElementById("mileageResult").innerText]);
      }
      if(type==="tax"){
        data.push(["Income",document.getElementById("income").value]);
        data.push(["Deductions",document.getElementById("deductions").value]);
        data.push(["Tax Result",document.getElementById("taxResult").innerText]);
      }
      const ws=XLSX.utils.aoa_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,"Report");
      XLSX.writeFile(wb,`${type}_report.xlsx`);
    }

    function sendExcel(type){
      const email=document.getElementById(type+"Email").value.trim();
      if(!email)return alert("Enter recipient email!");
      let data=[["Field","Value"]];
      if(type==="expense"){const s=parseFloat(document.getElementById("salary").value)||0;let t=categories.reduce((a,c)=>a+(c.value||0),0);let b=s-t;categories.forEach(c=>data.push([c.name,c.value]));data.push(["Total",t],["Salary",s],["Balance",b]);}
      if(type==="emi"){data.push(["Loan",document.getElementById("loanAmount").value],["Rate",document.getElementById("interestRate").value],["Tenure",document.getElementById("tenure").value],["EMI",document.getElementById("emiResult").innerText]);}
      if(type==="mileage"){data.push(["Distance",document.getElementById("distance").value],["Fuel",document.getElementById("fuel").value],["Mileage",document.getElementById("mileageResult").innerText]);}
      if(type==="tax"){data.push(["Income",document.getElementById("income").value],["Deductions",document.getElementById("deductions").value],["Result",document.getElementById("taxResult").innerText]);}
      const ws=XLSX.utils.aoa_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,"Report");
      const excelBinary=XLSX.write(wb,{bookType:"xlsx",type:"base64"});
      emailjs.send("YOUR_SERVICE_ID","YOUR_TEMPLATE_ID",{to_email:email,message:"Report attached",attachment:excelBinary})
      .then(()=>alert("‚úÖ Email sent!"))
      .catch(e=>alert("‚ùå Failed: "+JSON.stringify(e)));
    }
  </script>
</body>
</html>
